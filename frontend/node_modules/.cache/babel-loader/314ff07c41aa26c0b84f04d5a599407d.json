{"ast":null,"code":"var _jsxFileName = \"/Users/yilinxia/Downloads/react_tutorial_2/frontend/src/screens/PlaceOrderScreen.js\",\n    _s = $RefreshSig$();\n\nimport Axios from 'axios';\nimport React, { useContext, useEffect, useReducer } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Helmet } from 'react-helmet-async';\nimport CheckoutSteps from '../components/CheckoutSteps';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport { Store } from '../Store';\nimport { getError } from '../utils';\nimport { toast } from 'react-toastify';\nimport LoadingBox from '../components/LoadingBox';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'CREATE_REQUEST':\n      return { ...state,\n        loading: true\n      };\n\n    case 'CREATE_SUCCESS':\n      return { ...state,\n        loading: false\n      };\n\n    case 'CREATE_FAIL':\n      return { ...state,\n        loading: false\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default function PlaceOrderScreen() {\n  _s();\n\n  const navigate = useNavigate();\n  const [{\n    loading\n  }, dispatch] = useReducer(reducer, {\n    loading: false\n  });\n  const {\n    state,\n    dispatch: ctxDispatch\n  } = useContext(Store);\n  const {\n    cart,\n    userInfo\n  } = state;\n\n  const roundTo = num => Math.round(num * 100 + Number.EPSILON) / 100; // rounds decimals to 2dp\n\n\n  cart.itemsPrice = roundTo(cart.cartItems.reduce((a, c) => a + c.quantity * c.price, 0));\n  cart.shippingPrice = cart.itemsPrice / 10;\n  cart.totalPrice = cart.itemsPrice + cart.shippingPrice;\n\n  const placeOrderHandler = async () => {\n    try {\n      dispatch({\n        type: 'CREATE_REQUEST'\n      }); //authentication//\n\n      const {\n        data\n      } = await Axios.post('/api/orders', {\n        orderItems: cart.cartItems,\n        shippingAddress: cart.shippingAddress,\n        paymentMethod: cart.paymentMethod,\n        itemsPrice: cart.itemsPrice,\n        totalPrice: cart.totalPrice\n      }, {\n        headers: {\n          authorization: `Bearer ${userInfo.token}`\n        }\n      });\n      ctxDispatch({\n        type: 'CART_CLEAR'\n      });\n      dispatch({\n        type: 'CREATE_SUCCESS'\n      });\n      localStorage.removeItem('cartItems');\n      navigate(`/order/${data.order._id}`);\n    } catch (err) {\n      dispatch({\n        type: 'CREATE_FAIL'\n      });\n      toast.error(getError(err));\n    }\n  };\n\n  useEffect(() => {\n    if (!cart.paymentMethod) {\n      navigate('/payment');\n    }\n  }, [cart, navigate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(CheckoutSteps, {\n      step1: true,\n      step2: true,\n      step3: true,\n      step4: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Helmet, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Preview Order\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"my-3\",\n      children: \"Preview Order\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 8,\n        children: [/*#__PURE__*/_jsxDEV(Card, {\n          className: \"mb-3\",\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n              children: \"Shipping\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Card.Text, {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Name:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 17\n              }, this), \" \", cart.shippingAddress.fullName, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 72\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Address:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 17\n              }, this), \" \", cart.shippingAddress.address, \",\", cart.shippingAddress.city, \", \", cart.shippingAddress.postalCode, \",\", cart.shippingAddress.country]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/shipping\",\n              children: \"Edit Shipping\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Card, {\n          className: \"mb-3\",\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n              children: \"Payment\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Card.Text, {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Method:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 17\n              }, this), \" \", cart.paymentMethod]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/payment\",\n              children: \"Edit Payment\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Card, {\n          className: \"mb-3\",\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n              children: \"Items\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: cart.cartItems.map(item => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  className: \"align-items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                      src: item.image,\n                      alt: item.name,\n                      className: \"img-fluid rounded img-thumbnail\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 123,\n                      columnNumber: 27\n                    }, this), ' ', /*#__PURE__*/_jsxDEV(Link, {\n                      to: `/product/${item.slug}`,\n                      children: item.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 124,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 122,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 3,\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: item.quantity\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 127,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 126,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 3,\n                    children: [\"$\", item.price * item.quantity]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 129,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 121,\n                  columnNumber: 23\n                }, this)\n              }, item._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/cart\",\n              children: \"Edit Cart\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n              children: \"Order Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Items\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 147,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", cart.itemsPrice.toFixed(2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 148,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: \"Shipping\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: [\"$\", cart.shippingPrice.toFixed(2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 154,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Order Total\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 159,\n                      columnNumber: 26\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 159,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: [\"$\", cart.totalPrice.toFixed(2)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 160,\n                      columnNumber: 26\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-grid\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"button\",\n                    onClick: placeOrderHandler,\n                    disabled: cart.cartItems.length === 0,\n                    children: \"Place Order\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 19\n                }, this), loading && /*#__PURE__*/_jsxDEV(LoadingBox, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 167,\n                  columnNumber: 31\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PlaceOrderScreen, \"PechVhq9o1XHcMggJwV4f4kQbGs=\", false, function () {\n  return [useNavigate];\n});\n\n_c = PlaceOrderScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlaceOrderScreen\");","map":{"version":3,"sources":["/Users/yilinxia/Downloads/react_tutorial_2/frontend/src/screens/PlaceOrderScreen.js"],"names":["Axios","React","useContext","useEffect","useReducer","Link","useNavigate","Helmet","CheckoutSteps","Row","Col","Card","Button","ListGroup","Store","getError","toast","LoadingBox","reducer","state","action","type","loading","PlaceOrderScreen","navigate","dispatch","ctxDispatch","cart","userInfo","roundTo","num","Math","round","Number","EPSILON","itemsPrice","cartItems","reduce","a","c","quantity","price","shippingPrice","totalPrice","placeOrderHandler","data","post","orderItems","shippingAddress","paymentMethod","headers","authorization","token","localStorage","removeItem","order","_id","err","error","fullName","address","city","postalCode","country","map","item","image","name","slug","toFixed","length"],"mappings":"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","sourcesContent":["import Axios from 'axios';\nimport React, { useContext, useEffect, useReducer } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Helmet } from 'react-helmet-async';\nimport CheckoutSteps from '../components/CheckoutSteps';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport { Store } from '../Store';\nimport { getError } from '../utils';\nimport { toast } from 'react-toastify';\nimport LoadingBox from '../components/LoadingBox';\n\n\nconst reducer = (state, action) => {\n  switch(action.type) {\n    case 'CREATE_REQUEST':\n      return { ...state, loading: true };\n    case 'CREATE_SUCCESS':\n      return { ...state, loading: false };\n    case 'CREATE_FAIL':\n      return { ...state, loading: false };\n    default:\n      return state;\n  }\n}\n\nexport default function PlaceOrderScreen() {\n  const navigate = useNavigate();\n\n  const [{loading}, dispatch] = useReducer(reducer, {\n    loading: false,\n  });\n  const { state, dispatch: ctxDispatch } = useContext(Store);\n  const { cart, userInfo } = state;\n\n  const roundTo = (num) => Math.round(num*100+Number.EPSILON) / 100; // rounds decimals to 2dp\n\n  cart.itemsPrice = roundTo(\n    cart.cartItems.reduce((a, c) => a+c.quantity*c.price, 0)\n  );\n\n  cart.shippingPrice = cart.itemsPrice/10;\n  cart.totalPrice = cart.itemsPrice + cart.shippingPrice;\n\n  const placeOrderHandler = async() => {\n    try {\n      dispatch({type: 'CREATE_REQUEST'});\n\n      //authentication//\n\n      const { data } = await Axios.post(\n        '/api/orders',\n        {\n          orderItems: cart.cartItems,\n          shippingAddress: cart.shippingAddress,\n          paymentMethod: cart.paymentMethod,\n          itemsPrice: cart.itemsPrice,\n          totalPrice: cart.totalPrice,\n        },\n        {\n          headers: {\n            authorization: `Bearer ${userInfo.token}`,\n          },\n        }\n      );\n      ctxDispatch({type: 'CART_CLEAR'});\n      dispatch({type: 'CREATE_SUCCESS'});\n      localStorage.removeItem('cartItems');\n      navigate(`/order/${data.order._id}`);\n    } catch(err) {\n      dispatch({type: 'CREATE_FAIL'});\n      toast.error(getError(err));\n    }\n  };\n\n  useEffect(() => {\n    if (!cart.paymentMethod) {\n      navigate('/payment');\n    }\n  }, [cart, navigate]);\n\n  return (\n    <div>\n      <CheckoutSteps step1 step2 step3 step4></CheckoutSteps>\n      <Helmet>\n        <title>Preview Order</title>\n      </Helmet>\n      <h1 className=\"my-3\">Preview Order</h1>\n      <Row>\n        <Col md={8}>\n          <Card className=\"mb-3\">\n            <Card.Body>\n              <Card.Title>Shipping</Card.Title>\n              <Card.Text>\n                <strong>Name:</strong> {cart.shippingAddress.fullName} <br />\n                <strong>Address:</strong> {cart.shippingAddress.address},\n                {cart.shippingAddress.city}, {cart.shippingAddress.postalCode},\n                {cart.shippingAddress.country}\n              </Card.Text>\n              <Link to=\"/shipping\">Edit Shipping</Link>\n            </Card.Body>\n          </Card>\n          <Card className=\"mb-3\">\n            <Card.Body>\n              <Card.Title>Payment</Card.Title>\n              <Card.Text>\n                <strong>Method:</strong> {cart.paymentMethod}\n              </Card.Text>\n              <Link to=\"/payment\">Edit Payment</Link>\n            </Card.Body>\n          </Card>\n          <Card className=\"mb-3\">\n            <Card.Body>\n              <Card.Title>Items</Card.Title>\n                <ListGroup variant=\"flush\">\n                  {cart.cartItems.map((item) => (\n                    <ListGroup.Item key={item._id}>\n                      <Row className=\"align-items-center\">\n                        <Col md={6}>\n                          <img src={item.image} alt={item.name} className=\"img-fluid rounded img-thumbnail\"></img>{' '}\n                          <Link to={`/product/${item.slug}`}>{item.name}</Link>\n                        </Col>\n                        <Col md={3}>\n                          <span>{item.quantity}</span>\n                        </Col>\n                        <Col md={3}>\n                          ${item.price*item.quantity}\n                        </Col>\n                      </Row>\n                    </ListGroup.Item>\n                  ))}\n                </ListGroup>\n              <Link to=\"/cart\">Edit Cart</Link>\n            </Card.Body>\n          </Card>\n        </Col>\n        <Col md={4}>\n          <Card>\n            <Card.Body>\n              <Card.Title>Order Summary</Card.Title>\n              <ListGroup variant=\"flush\">\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Items</Col>\n                    <Col>${cart.itemsPrice.toFixed(2)}</Col>\n                  </Row>\n                </ListGroup.Item>\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Shipping</Col>\n                    <Col>${cart.shippingPrice.toFixed(2)}</Col>\n                  </Row>\n                </ListGroup.Item>\n                <ListGroup.Item>\n                  <Row>\n                    <Col><strong>Order Total</strong></Col>\n                    <Col><strong>${cart.totalPrice.toFixed(2)}</strong></Col>\n                  </Row>\n                </ListGroup.Item>\n                <ListGroup.Item>\n                  <div className=\"d-grid\">\n                    <Button type=\"button\" onClick={placeOrderHandler} disabled={cart.cartItems.length === 0}>Place Order</Button>\n                  </div>\n                  {loading && <LoadingBox />}\n                </ListGroup.Item>\n              </ListGroup>\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}